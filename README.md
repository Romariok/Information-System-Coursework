
# GMatch

## Описание проекта

Проект представляет собой инновационный веб-сервис по подбору гитар и музыкального оборудования, разработанный в рамках курсовой работы по информационным системам (ИТМО, ПИиКТ-СиППО, 3 курс). Система создана для помощи гитаристам с разным уровнем опыта в выборе идеального инструмента и сопутствующего оборудования.

## Предметная область

Сервис по подбору гитар и оборудования позволяет пользователям с разным опытом в сфере гитар получить рекомендации по выбору нужной модели гитар и оборудования. В поиске учитываются не только базовые параметры (цена, материал, форма), но и информация о том, какие модели использовали популярные исполнители различных жанров.

База данных сервиса содержит информацию о многих исполнителях: используемое ими оборудование и подтверждающие материалы. Для всех моделей на сайте представлены статьи и обзоры от других пользователей, помогающие сделать осознанный выбор.

## Реализованная функциональность

### Бэкенд (Spring Boot)

- REST API с многочисленными эндпоинтами для обработки запросов
- Система работы с различными сущностями:
  - Продукты (гитары и оборудование)
  - Музыканты
  - Бренды
  - Магазины
  - Статьи/обзоры
  - Пользователи
- Полноценная пагинация данных
- Система фильтрации и сортировки товаров

### Фронтенд (TypeScript + React)

- Современный пользовательский интерфейс с использованием Tailwind CSS
- Модуль сервисов для взаимодействия с API
- Система навигации между различными разделами сайта
- Функционал для просмотра детальной информации о продуктах

### Ключевые фичи

- **Расширенный поиск и фильтрация**: многокритериальный поиск по различным параметрам
- **База данных музыкантов**: информация о том, какое оборудование используют известные исполнители
- **Система обзоров и статей**: возможность создавать и читать статьи о различных моделях гитар
- **Интеграция с магазинами**: информация о том, где можно приобрести выбранную модель и по какой цене
- **Подписка на музыкантов**: отслеживание оборудования любимых исполнителей
- **Модерация контента**: система для проверки пользовательских статей

## Общие задачи системы

1. Предоставить пользователям достаточное количество фильтров для поиска
2. Предоставить пользователям достаточно информации по каждой модели
3. Предоставить возможность писать статьи по каждой модели
4. Предоставить пользователям доступ к базе данных, что использует исполнитель
5. Предоставить возможность пользователям обновлять базу данных исполнителей

## Текущий статус разработки

Проект находится в активной фазе разработки. Основная архитектура системы создана, большинство ключевых API-эндпоинтов уже функционирует. Система демонстрирует хорошую организацию кода с чётким разделением на фронтенд и бэкенд компоненты.

## Архитектурные решения

В проекте реализована клиент-серверная архитектура с разделением на фронтенд (React + TypeScript) и бэкенд (Spring Boot). Используется RESTful API для взаимодействия между клиентской и серверной частями. База данных структурирована для эффективного хранения взаимосвязей между различными сущностями системы.

## Отчёт

- [2 этап](./docs/2_step/README.MD)
- [3 этап](./docs/3_step/README.MD)

## Планы

### Этап 1. Улучшение логирования и найстройка метрик и дашбордов

- Логирование бекенда (добавление логов в ключевых местах, настройка уровней логирования). Поможет в отладке и мониторинге работы сервиса на следующих этапах.
- Настройка метрик и дашбордов с помощью Prometheus/Micrometer и Grafana. Позволит отслеживать производительность и состояние системы в реальном времени. Сможем легко проверить, улучшилась ли производительность после оптимизаций на следующих этапах.
- Вынести все магические числа и строки в конфигурационные файлы. Облегчит поддержку и изменение настроек системы в будущем. Позволит задавать параметры для докера (см. этап 2).

### Этап 2. Контейнеризация, CI/CD, безопасность

- Создание Docker для фронтенда и бэкенда. Позволит одной командой запускать весь проект локально или на сервере.
- Настройка CI/CD для автоматической сборки и деплоя приложения. Собранный образ можно размещать в релизах на GitHub.
- Настройка статического анализатора кода (OWASP) в CI/CD для бэкенда. Повысит безопасность и качество кода.
- Настройка проверки уязвимостей в зависимостях (Dependabot/Snyk) для бэкенда. Обеспечит своевременное обновление библиотек и снижение рисков безопасности.
- Настройка линтинга кода (ESLint/Prettier) для фронтенда. Повысит качество и читаемость кода.
- Вынести логику парсера в Async задачи (Spring @Async). Улучшит отзывчивость сервиса при добавлении новых исполнителей/гитар/статей.

### Этап 3. Оптимизация производительности

- Настроить Redis для кэширования часто запрашиваемых данных. Снизит нагрузку на базу данных и ускорит отклик сервиса.
- Оптимизировать запросы к базе данных (индексы, оптимизация SQL-запросов). Улучшит производительность при большом количестве пользователей.

### Что хотелось бы добавить ещё, если будет время

- Настроить https для безопасности передачи данных.
- Настройки производительности приложения (пул соединений, оптимизация JVM, настройка postgreSQL).

## Метрики и дашборды (Prometheus/Micrometer/Grafana)

Добавлена интеграция метрик в бэкенд и инфраструктура мониторинга.

- Бэкенд: `spring-boot-starter-actuator` + `micrometer-registry-prometheus`.
- Эндпоинт метрик: `GET /actuator/prometheus`.
- Prometheus и Grafana добавлены в `.docker/docker-compose.yaml`.
- Grafana автоматически настраивает datasource и загружает дашборд `Spring Boot Overview`.

### Как запустить локально

1) Запустить бэкенд (по умолчанию порт 8080, можно задать `PORT`):

```bash
mvn -f backend/pom.xml spring-boot:run
```

2) Запустить Prometheus и Grafana:

```bash
cd .docker
docker compose up -d prometheus grafana
```

3) Открыть:
- Prometheus: `http://localhost:9090`
- Grafana: `http://localhost:3000` (логин/пароль: `admin`/`admin`)
- Дашборды в Grafana: папка `Spring`, дашборд `Spring Boot Overview`

### Настройки

- Точка скрейпа настроена в `.docker/prometheus/prometheus.yml` на `host.docker.internal:8080/actuator/prometheus`.
  - Если бэкенд слушает другой порт — обновить `targets`.
  - Если бэкенд будет запущен в Docker-сети — укажите имя сервиса и порт, например `backend:8080`.
- Конфигурация Grafana:
  - Datasource: `.docker/grafana/provisioning/datasources/datasource.yml`
  - Дашборды: `.docker/grafana/dashboards/`

### Полезные метрики

- HTTP: `http_server_requests_seconds_count`, гистограмма `http_server_requests_seconds_bucket`
- JVM: `jvm_memory_used_bytes`, `jvm_threads_live_threads`, `process_cpu_usage`
- База данных (через Hikari/JPA): `hikaricp_connections_active`, `jdbc_connections_active`

### Метрики контейнеров (CPU/RAM/Disk/Net)

- Добавлен `cAdvisor` в `.docker/docker-compose.yaml`. Запуск вместе со стеком:
  ```bash
  cd .docker
  docker compose up -d prometheus grafana cadvisor
  ```
- Prometheus-джоб `cadvisor` уже подключен.
- На дашборде добавлены панели: Containers CPU/Memory/FS usage/Net IO.
